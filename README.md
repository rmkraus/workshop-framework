# Workshop Framework

Tooling for building workshops quickly.

## Prerequisites

- Docker installed and running on your system
    - On Windows and Mac, check out (Rancher Desktop)[https://rancherdesktop.io/]
    - On Linux, install (Docker Engine)[https://docs.docker.com/engine/install/].
- *[OPTIONAL]* `pipx` installed on your system
    - There are many ways to (install pipx)[https://pipx.pypa.io/stable/installation/]. Here are some common ones:
        - On Windows: `python3 -m pip install --user pipx`
        - On Mac: `brew install pipx`
        - On Linux: `python3 -m pip install --user pipx`


## Install

The easiest way to install this tooling is with `pipx`.

```bash
pipx install git+https://github.com/rmkraus/workshop-framework.git

devx --help
```

## Create a GitHub repo

This framework is only compatible with public GitHub repos.

Initial development can happen locally with any Git server, but everything must be pushed to GitHub in order to publish the Launchable to Brev.

When you create your GitHub repo, you must allow Actions to save new Container Images.

- Go to your repository's settings.
- `Actions` -> `General`
- In `Workflow permissions`, select `Read and write permissions`
- Click `Save`

This allows your repository to ensure that a container image is always staged for the Launchable.

## Quick start

Clone your public GitHub repository.

```bash
git clone git@github.com:rmkraus/test-workshop.git
```

Initialize the workshop files.

```bash
cd test-workshop
devx init
```

## Editing the lab manual

The .devx folder contains the lab manual content:

```
.devx/
├── README.md             # Manual landing page
├── _sidebar.yaml         # Manual navigation layout
├── _static               # Static files for the manual
├── docker-compose.yaml   # AUTO GENERATED by `devx sync`
├── index.html            # Website template
├── jp_app_launcher.yaml  # Jupyter application launcher configuration
└── *.md                  # Manual Pages
```

## Testing your workshop

You may have a machine outside of Brev that you'd like to use for creating your workshop.

To start your workshop on your own machine:

```bash
devx start
```

## Debugging

If your workshop fails to start, you can use Docker CLI commands to inspect the failure:

```bash
# List all containers (including stopped ones)
docker ps -a

# Check container logs
docker logs devx-devx-1

# Inspect container details
docker inspect devx-devx-1

# Start an interactive shell in the container
docker exec -it devx-devx-1 /bin/bash
```

## Publish the workshop

The code on the main branch of the repo is what will be targetted by your Launchable.

Once you are happy with the state, synchronize the docker compose files:

```bash
devx sync
```

Then push the changes to GitHub. You may want to use Pull Requests.

```bash
git add -A
git commit -m "testing"
git push
```

Create your Brev launchable.

```bash
devx publish
```

## Developing the framework

To develop this tool, create a virtual environment and install an editable copy.

```bash
python3 -m venv .venv
source .venv/bin/activate
pip isntall -e .

devx --help
```
